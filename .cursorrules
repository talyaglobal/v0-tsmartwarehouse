# Cursor AI Rules for Warebnb Project

## Supabase Migration Auto-Push Policy

When creating or modifying Supabase migration files:
1. **Automatically attempt to push** the migration using `supabase db push` or `npx supabase db push`
2. If push fails due to CLI not being installed/linked:
   - Note this in the response
   - Migration file is ready for manual execution via Supabase Dashboard
3. If migration errors occur during push:
   - Fix the errors in the migration file
   - Attempt to push again automatically
4. **Never ask the user to manually push migrations** - handle this automatically

## Build Verification Policy (MANDATORY)

After completing any code changes:
1. **Automatically run** `npm run build` to verify the build
2. If build errors occur:
   - Fix all TypeScript/compilation errors
   - Run build again
   - Repeat until build succeeds
3. **Never leave code in a broken state** - build must pass
4. **Never ask user to run build or fix errors** - handle this automatically

## General Development Rules

- Always use TypeScript with strict type checking
- Follow the existing code patterns and architecture
- Use server components by default, client components only when needed
- All user-facing text must be in English (no Turkish)
- Write comprehensive error handling
- Update relevant documentation when making significant changes

## Root User Test Mode (Development Feature)

Root kullan覺c覺, sistemdeki t羹m rolleri ger癟ek zamanl覺 olarak test edebilir:

1. **Role Switcher**: `/admin` veya `/dashboard` sayfas覺nda role switcher ile farkl覺 rollere ge癟i yapabilir
2. **Test Data 襤aretleme**: Root kullan覺c覺n覺n oluturduu veriler i癟in "妒 Test Data" badge g繹sterilir
3. **Test Data Badge**: Dier kullan覺c覺lar root taraf覺ndan oluturulan verileri g繹r羹nt羹lediinde badge g繹sterilir

### 襤lgili Dosyalar:
- `components/ui/root-test-data-badge.tsx` - Test data badge komponenti
- `lib/utils/test-data.ts` - Test data yard覺mc覺 fonksiyonlar覺
- `documents/DEVELOPMENT_RULES.md` - Detayl覺 dok羹mantasyon

### Kullan覺m:
```tsx
import { RootTestDataBadge, RootTestDataIndicator } from "@/components/ui/root-test-data-badge"
import { getRootUserIds, isTestDataSync } from "@/lib/utils/test-data"

// Komponentte:
const [rootUserIds, setRootUserIds] = useState<string[]>([])
useEffect(() => { getRootUserIds().then(setRootUserIds) }, [])

// Badge g繹sterimi:
{isTestDataSync(item.customerId, rootUserIds) && <RootTestDataIndicator />}
```
